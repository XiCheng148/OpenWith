# 文件打开方式管理工具需求文档

## 1. 项目概述
- 开发一个 macOS 应用程序，用于管理应用程序与文件类型之间的关联关系
- 以应用程序为中心，快速查看和修改文件关联

## 2. 功能需求

### 2.1 应用程序管理
- 显示系统中所有已安装的应用程序列表
- 显示应用程序详细信息：
  - 应用程序名称和图标
  - 应用程序路径
  - 当前关联的所有文件类型
  - 可以关联的所有文件类型
- 支持搜索和过滤应用程序

### 2.2 文件关联管理
- 查看当前应用程序的文件关联状态：
  - 已关联的文件类型列表
  - 每个文件类型的图标和描述
  - 文件类型的当前默认打开方式
- 文件关联操作：
  - 添加新的文件类型关联
  - 移除现有文件类型关联
  - 设置为默认打开方式
  - 批量修改文件关联

### 2.3 用户界面设计
- 双栏式布局：
  - 左侧：应用程序列表
    - 支持按名称搜索
    - 显示应用图标和名称
    - 标记当前选中应用
  - 右侧：文件关联管理面板
    - 显示当前应用详细信息
    - 已关联文件类型列表
    - 可关联文件类型列表
    - 添加/移除文件类型的操作按钮
- 动画交互：
  - 切换应用时，右侧面板内容优雅淡入/淡出
  - 添加/移除文件类型时显示平滑的动画效果
  - 批量操作时显示连贯的动画序列

### 2.4 界面原型
```
基础界面:
+------------------------------------------+
|                                          |
+------------------+-----------------------+
| 搜索框           |                       |
|------------------|                       |
| > Chrome         |                       |
|   图标 名称      |                       |
|------------------|                       |
| > Safari         | 已关联文件类型:        |
|   图标 名称      | □ .html               |
|------------------|  [移除]               |
| > VS Code        | □ .js                 |
|   图标 名称      |  [移除]               |
|------------------|                       |
| > Xcode          | + 添加文件类型         |
|   图标 名称      |                       |
|------------------|                       |
+------------------+-----------------------+
|  状态栏: 操作反馈                         |
+------------------------------------------+

+ 添加文件类型界面:
+ +------------------------------------------+
+ |                                          |
+ +------------------+-----------------------+
+ | 搜索框           |                       |
+ |------------------|     添加文件类型      |
+ | > Chrome         | [搜索文件类型...]      |
+ |   图标 名称      |                       |
+ |------------------| 常用类型:             |
+ |                  | ○ .txt  ○ .pdf        |
+ |                  | ○ .jpg  ○ .png        |
+ |                  |                       |
+ |                  | 所有类型:             |
+ |                  | 文档                  |
+ |                  | ○ .doc  ○ .docx       |
+ |                  | ○ .rtf  ○ .odt        |
+ |                  |                       |
+ |                  | 图片                  |
+ |                  | ○ .jpg  ○ .png        |
+ |                  | ○ .gif  ○ .webp       |
+ |                  |                       |
+ |                  | [取消]  [添加选中项]   |
+ +------------------+-----------------------+
+ |  选择要添加的文件类型                     |
+ +------------------------------------------+
  ```

  界面说明：
  1. 左侧面板
     - 顶部搜索框用于快速查找应用
     - 应用列表显示图标和名称
     - 选中项带有优雅的高亮动画

  2. 右侧面板
     - 以动画方式显示已关联文件类型列表
       - 复选框支持批量操作
       - 每项显示扩展名和移除按钮
     - 底部显示添加文件类型按钮
     - 所有操作都伴随平滑动画

  3. 状态栏
     - 显示操作反馈信息
     - 显示操作结果状态

  4. 添加文件类型面板
     - 搜索框支持快速查找文件类型
     - 常用类型区域显示最常见的文件类型
     - 所有类型按分类组织展示
     - 支持多选文件类型
     - 底部操作按钮用于确认或取消
     - 面板显示/隐藏时有平滑动画

## 3. 技术要求

### 3.1 系统要求
- macOS 13.0 或更高版本
- 使用 SwiftUI 构建用户界面
- 遵循 macOS 设计规范

### 3.2 核心 API 使用
- `LSCopyApplicationURLsForURL` - 获取应用程序支持的文件类型
- `LSSetDefaultRoleHandlerForContentType` - 设置默认打开方式
- `UTType` - 处理文件类型信息
- `NSWorkspace` - 获取应用程序信息

### 3.3 数据存储
- 缓存应用程序列表
- 保存用户最近的操作记录
- 支持导入/导出配置

## 4. 用户体验要求
- 操作流程简单直观
- 实时预览关联效果
- 提供操作确认机制
- 清晰的状态反馈
